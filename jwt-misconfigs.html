<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT Attack Methods - Ethical Hacking Guide</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #2ecc71;
            --light: #ecf0f1;
            --dark: #2c3e50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        nav {
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            top: 0;
            z-index: 100;
        }

        .nav-container {
            display: flex;
            justify-content: center;
        }

        .nav-link {
            padding: 1rem 1.5rem;
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background-color: var(--light);
            color: var(--secondary);
        }

        main {
            padding: 2rem 0;
        }

        .section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-title {
            color: var(--primary);
            border-bottom: 2px solid var(--light);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }

        .section-title i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .step {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
            border-left: 3px solid var(--secondary);
        }

        .step-number {
            display: inline-block;
            background-color: var(--secondary);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            text-align: center;
            line-height: 24px;
            margin-right: 10px;
            font-size: 0.8rem;
        }

        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
            white-space: pre-wrap;
        }

        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .danger-box {
            background-color: #f8d7da;
            border-left: 4px solid var(--danger);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .success-box {
            background-color: #d1ecf1;
            border-left: 4px solid var(--success);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        footer {
            background-color: var(--dark);
            color: white;
            text-align: center;
            padding: 1.5rem 0;
            margin-top: 2rem;
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
            }

            .nav-link {
                text-align: center;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1>JWT Attack Methods</h1>
            <a href="index.html" style="color: #e2e8f0;" class="back-btn">⬅ Go Back</a>
        </div>
    </header>

    <nav>
        <div class="nav-container">
            <a href="#algorithm-confusion" class="nav-link">Algorithm Confusion</a>
            <a href="#algorithm-confusion-2" class="nav-link">Algorithm Confusion (no jwks exposed)</a>
            <a href="#header-injection" class="nav-link">Header Injection</a>
            <a href="#kid-traversal" class="nav-link">KID Path Traversal</a>
            <a href="#jku-injection" class="nav-link">JKU Injection</a>
        </div>
    </nav>

    <main class="container">
        <div class="warning-box">
            <strong>Important:</strong> This information is for educational purposes only. Only use these techniques on
            systems you own or have explicit permission to test.
        </div>

        <section id="algorithm-confusion" class="section">
            <h2 class="section-title">Algorithm Confusion Attack (with jwks.json)</h2>

            <p>This attack exploits applications that don't properly verify the signing algorithm used in JWT tokens.
            </p>

            <div class="step">
                <span class="step-number">1</span>
                <strong>Navigate to /jwks.json</strong> to copy the key (JWK)
            </div>

            <div class="step">
                <span class="step-number">2</span>
                Use the <strong>JWT Editor extension</strong> in Burp Suite
            </div>

            <div class="step">
                <span class="step-number">3</span>
                Click <strong>"New RSA Key"</strong> and paste the JWK
            </div>

            <div class="step">
                <span class="step-number">4</span>
                Click <strong>"PEM"</strong> and copy the public key generated
            </div>

            <div class="step">
                <span class="step-number">5</span>
                Go to the Decoder and encode the public key as <strong>Base64</strong>
            </div>

            <div class="step">
                <span class="step-number">6</span>
                Copy the Base64 string and go to the JWT extension again
            </div>

            <div class="step">
                <span class="step-number">7</span>
                Click <strong>"New Symmetric Key"</strong> then click Generate
            </div>

            <div class="step">
                <span class="step-number">8</span>
                Update the <strong>"k" parameter</strong> to the Base64 string
            </div>

            <div class="step">
                <span class="step-number">9</span>
                Edit the payload (e.g., changing the user to admin)
            </div>

            <div class="step">
                <span class="step-number">10</span>
                Sign the JWT with the generated key (the key where we changed the k parameter)
            </div>

            <div class="success-box">
                <strong>Result:</strong> The application will verify the token using the public key as a symmetric key,
                allowing you to forge valid tokens.
            </div>
        </section>

        <section id="algorithm-confusion-2" class="section">
            <h2 class="section-title">Algorithm Confusion — jwks.json not exposed</h2>

            <p>When the JWKS endpoint isn't exposed, we can use a different approach.</p>

            <div class="step">
                <span class="step-number">1</span>
                Grab two JSON Web Tokens from the application
            </div>

            <div class="step">
                <span class="step-number">2</span>
                Run this command:
                <div class="code-block">docker run --rm -it portswigger/sig2n token1 token2</div>
            </div>

            <div class="step">
                <span class="step-number">3</span>
                Try the two "tampered" JWT tokens generated
            </div>

            <div class="step">
                <span class="step-number">4</span>
                If the first JWT token works, copy the first base64 encoded X.509 key, vice versa
            </div>

            <div class="step">
                <span class="step-number">5</span>
                Generate <strong>"New Symmetric Key"</strong>
            </div>

            <div class="step">
                <span class="step-number">6</span>
                Update <strong>"k"</strong> to the base64 X.509 key you copied
            </div>

            <div class="step">
                <span class="step-number">7</span>
                Edit the payload (e.g., changing the user to admin)
            </div>

            <div class="step">
                <span class="step-number">8</span>
                Sign it with the generated key
            </div>

            <div class="danger-box">
                <strong>Note:</strong> This attack exploits the fact that some libraries use the same key for both
                signing and verification when the algorithm is confused.
            </div>
        </section>

        <section id="header-injection" class="section">
            <h2 class="section-title">JWT Header Injection</h2>

            <p>This attack injects malicious content into the JWT header to manipulate token processing.</p>

            <div class="step">
                <span class="step-number">1</span>
                Click <strong>"New RSA Key"</strong> and generate the key
            </div>

            <div class="step">
                <span class="step-number">2</span>
                Edit the payload (e.g., changing user to admin)
            </div>

            <div class="step">
                <span class="step-number">3</span>
                Click <strong>Attack</strong>
            </div>

            <div class="step">
                <span class="step-number">4</span>
                Click <strong>Embedded JWK</strong> then click 'OK'
            </div>

            <div class="step">
                <span class="step-number">5</span>
                Send the request
            </div>

            <div class="success-box">
                <strong>Result:</strong> The embedded JWK in the header will be used to verify the signature, bypassing
                the server's key validation.
            </div>
        </section>

        <section id="kid-traversal" class="section">
            <h2 class="section-title">KID Path Traversal</h2>

            <p>This attack exploits the Key ID (kid) parameter to perform path traversal and load unintended keys.</p>

            <div class="step">
                <span class="step-number">1</span>
                Generate new symmetric keys
            </div>

            <div class="step">
                <span class="step-number">2</span>
                Update <strong>"k"</strong> to <strong>"AA=="</strong> (which is a single null byte in Base64)
            </div>

            <div class="step">
                <span class="step-number">3</span>
                Navigate to Repeater, update <strong>kid</strong> to <strong>"../../dev/null"</strong>
            </div>

            <div class="step">
                <span class="step-number">4</span>
                Edit payload
            </div>

            <div class="step">
                <span class="step-number">5</span>
                Sign it
            </div>

            <div class="danger-box">
                <strong>Note:</strong> This attack works when the application uses the kid parameter to load keys from
                the filesystem without proper validation.
            </div>
        </section>

        <section id="jku-injection" class="section">
            <h2 class="section-title">JKU Injection</h2>

            <p>This attack injects a malicious JWK Set URL (jku) parameter to make the application use
                attacker-controlled keys.</p>

            <div class="step">
                <span class="step-number">1</span>
                Click <strong>"New RSA Key"</strong>
            </div>

            <div class="step">
                <span class="step-number">2</span>
                Generate the key and copy it
            </div>

            <div class="step">
                <span class="step-number">3</span>
                Create a <strong>jwks.json</strong> file with this format:
                <div class="code-block">{"keys":[paste_here]}</div>
            </div>

            <div class="step">
                <span class="step-number">4</span>
                Paste your generated key into the file
            </div>

            <div class="step">
                <span class="step-number">5</span>
                Host the jwks.json file on a server you control
            </div>

            <div class="step">
                <span class="step-number">6</span>
                Copy the key ID (kid) from your generated key
            </div>

            <div class="step">
                <span class="step-number">7</span>
                In the Repeater, add the <strong>jku parameter</strong> with your hosted URL and the <strong>kid
                    parameter</strong>
            </div>

            <div class="step">
                <span class="step-number">8</span>
                Sign the JWT
            </div>

            <div class="success-box">
                <strong>Result:</strong> The application will fetch the JWK Set from your server and use your key to
                verify the signature.
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <p>JWT Attack Methods - Educational Content for Ethical Hackers</p>
            <p>Always ensure you have proper authorization before testing these techniques.</p>
        </div>
    </footer>
</body>

</html>